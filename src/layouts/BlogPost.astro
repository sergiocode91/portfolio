---
import type { CollectionEntry } from "astro:content";
import Base from "@/layouts/Base.astro";
import Author from "@/components/Author.astro";

type Props = CollectionEntry<"blog">["data"];

const { title, description, imageUrl, author, authorImage, slug, createdDate, minutesRead  } = Astro.props;

// async function fetchData() {
//   const baseURL = 'http://localhost:3000';
//   const response = await fetch(`${baseURL}/api/${encodeURIComponent(slug)}`);

//   if (!response.ok) {
//     throw new Error(`HTTP error! status: ${response.status}`);
//   }

//   const text = await response.text();  // Primero obtenemos el texto de la respuesta
//   try {
//     const data = JSON.parse(text);     // Intentamos parsear el texto como JSON
//     return data;
//   } catch (error) {
//     console.error("Error parsing JSON:", error);
//     console.log("Received text:", text);  // Logueamos el texto para ver qué fue lo que se recibió
//     throw error;
//   }
// }

// const postData = await fetchData();
// console.log(postData);
---

<Base title={title} description={description} image={imageUrl} >
  <article class="py-16">
    <div class="flex flex-col gap-8">
      <h1 class="font-secondary text-3xl lg:text-4xl text-tertiary dark:text-primary">{title}</h1>
      <p class="text-sm lg:text-base text-tertiary dark:text-secondary leading-normal">{description}</p>
      <Author
        author={author}
        authorImage={authorImage}
        createdDate={createdDate}
        minutesRead={minutesRead}
      />
    </div>
  
    <div class="my-10">
      <img class="w-full h-auto lg:h-[440px] object-cover object-center rounded-lg" src={imageUrl} alt={title} />
    </div>

    <div class="text-sm lg:text-base text-tertiary dark:text-secondary prose prose-green prose-md md:prose-lg min-w-full">
      <slot />
    </div>
  </article>
</Base>
